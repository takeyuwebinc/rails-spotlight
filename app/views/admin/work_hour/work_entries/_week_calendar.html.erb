<div class="bg-white shadow rounded-lg overflow-hidden">
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-zinc-200">
      <thead class="bg-zinc-50">
        <tr>
          <% (start_date..end_date).each do |date| %>
            <th class="px-3 py-3 text-center text-xs font-medium text-zinc-500 uppercase tracking-wider min-w-[120px] <%= date == Date.current ? 'bg-indigo-50' : '' %>">
              <div><%= date.strftime("%m/%d") %></div>
              <div class="<%= date.wday == 0 ? 'text-red-500' : date.wday == 6 ? 'text-blue-500' : '' %>"><%= %w[日 月 火 水 木 金 土][date.wday] %></div>
            </th>
          <% end %>
        </tr>
      </thead>
      <tbody class="bg-white">
        <tr>
          <% (start_date..end_date).each do |date| %>
            <td class="px-2 py-2 align-top border-r border-zinc-200 <%= date == Date.current ? 'bg-indigo-50' : '' %>">
              <div class="space-y-1">
                <% (entries_by_date[date] || []).each do |entry| %>
                  <%= link_to edit_admin_work_hour_work_entry_path(entry), class: "block p-2 rounded text-xs hover:opacity-80", style: "background-color: #{entry.project&.color || '#9ca3af'}20; border-left: 3px solid #{entry.project&.color || '#9ca3af'}" do %>
                    <div class="font-medium text-zinc-900 truncate"><%= entry.project_name %></div>
                    <div class="text-zinc-600"><%= entry.minutes %>分</div>
                    <% if entry.description.present? %>
                      <div class="text-zinc-500 truncate"><%= entry.description %></div>
                    <% end %>
                  <% end %>
                <% end %>
                <%= link_to new_admin_work_hour_work_entry_path(date: date), class: "block p-1 text-center text-zinc-400 hover:text-indigo-600 hover:bg-indigo-50 rounded" do %>
                  <span class="text-lg">+</span>
                <% end %>
              </div>
            </td>
          <% end %>
        </tr>
        <tr class="bg-zinc-50">
          <% (start_date..end_date).each do |date| %>
            <%
              day_entries = entries_by_date[date] || []
              day_total = day_entries.sum(&:minutes)
              hours = day_total / 60
              minutes = day_total % 60
            %>
            <td class="px-3 py-2 text-center text-sm font-medium <%= date == Date.current ? 'bg-indigo-100' : '' %>">
              <% if day_total > 0 %>
                <span class="text-zinc-900"><%= hours %>時間<%= minutes > 0 ? "#{minutes}分" : "" %></span>
              <% else %>
                <span class="text-zinc-400">-</span>
              <% end %>
            </td>
          <% end %>
        </tr>
      </tbody>
    </table>
  </div>
</div>
