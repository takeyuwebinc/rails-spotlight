# ADR-009: Tag色システムの改善

## ステータス
承認済み

## 決定日
2025-05-24

## コンテキスト
Tagモデルでは単一の`color`フィールドを使用して基本的な色名（"red", "blue"など）を保存し、`badge_colors`メソッドでTailwind CSSクラスにマッピングしていました。しかし、この方法では：

1. 色の選択肢が限定的
2. Projectモデルとの一貫性がない（Projectは"purple-600"形式を使用）
3. 色の組み合わせが固定的で視覚的な多様性に欠ける

## 決定
Tagモデルの色システムを以下のように変更：

### データベース変更
- `color`フィールドを削除
- `bg_color`フィールドを追加（例: "purple-600"）
- `text_color`フィールドを追加（例: "purple-100"）

### 機能追加
- 新規作成時にランダムな色の組み合わせを自動設定
- 背景色の濃度に応じて適切なテキスト色を選択
- 濃い背景（600-900）には薄いテキスト（50-200）
- 薄い背景（100-400）には濃いテキスト（700-900）

### 色の選択肢
17種類のTailwind色ファミリーから選択：
red, orange, amber, yellow, lime, green, emerald, teal, cyan, sky, blue, indigo, violet, purple, fuchsia, pink, rose

## 結果
1. **視覚的多様性の向上**: より豊富な色の組み合わせが可能
2. **可読性の保証**: コントラスト比を考慮した自動色選択
3. **一貫性の確保**: Projectモデルと同じ色形式を採用
4. **保守性の向上**: 色の管理がより柔軟に

## 実装詳細
- マイグレーション: `ChangeTagColorToSeparateColors`
- 既存データの自動変換を含む
- FactoryBotの更新
- `badge_colors`メソッドの簡素化

## 影響
- 既存のTagデータは自動的に新形式に変換
- APIレスポンスの変更（`color` → `bg_color`, `text_color`）
- テストファクトリの更新が必要
